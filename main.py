import requests
from bs4 import BeautifulSoup
import time
import pandas as pd
import lxml
import html5lib
import csv
from openpyxl import Workbook


def get_categories():
    '''get all O*NET categories url links, into  1 list "categories". Purpose is to retrieve all scores for all categories using the list'''
    url=("https://www.onetonline.org/find/descriptor/browse/Skills/")
    source=requests.get(url)
    soup=BeautifulSoup(source.content, "html.parser")
    content=soup.find("div", id="content")
    options=content.find_all("option", value=True)
    categories=[]
    base_url = ("https://www.onetonline.org/find/descriptor/browse/")
    for option in options:
        category=option["value"]
        category=(base_url+category)
        categories.append(category)
    return categories



def get_sub_categories():
    '''get all O*NET sub categories url links, into  1 list "sub_categories". Purpose is to retrieve all scores for all sub_categories using the list'''
    max_i=(len(categories))-1
    print((max_i))
    i=0
    lst_sub_categories = []
    while i <= max_i:
        time.sleep(1)
        url=(categories[i])
        source=requests.get(url)
        soup=BeautifulSoup(source.content, "html.parser")
        content=soup.find("div", id="realcontent")
        for link in content.find_all("a", href=True):
            link_href=link.get("href")
            lst_sub_categories.append(link_href)
            # print(link["href"])
        i=i+1
    return lst_sub_categories




def all_url():
    '''changes the broken url from lst_subcategories from "def get_sub_categories()" to complete url and returns: lst_complete_url.

    To prevent O*NET overload the list has been copied from  "def get_sub_categories()" to lst_broken_url'''
    host_url=("https://www.onetonline.org")
    lst_broken_url=['/find/descriptor/browse/Abilities/1.A.1/', '/find/descriptor/browse/Abilities/1.A.1/', '/find/descriptor/browse/Abilities/1.A.3/', '/find/descriptor/browse/Abilities/1.A.3/', '/find/descriptor/browse/Abilities/1.A.2/', '/find/descriptor/browse/Abilities/1.A.2/', '/find/descriptor/browse/Abilities/1.A.4/', '/find/descriptor/browse/Abilities/1.A.4/', '/find/descriptor/result/1.A.1.b.7', '/find/descriptor/result/1.A.1.b.4', '/find/descriptor/result/1.A.1.e.2', '/find/descriptor/result/1.A.1.b.1', '/find/descriptor/result/1.A.1.b.5', '/find/descriptor/result/1.A.1.b.6', '/find/descriptor/result/1.A.1.c.1', '/find/descriptor/result/1.A.1.d.1', '/find/descriptor/result/1.A.1.c.2', '/find/descriptor/result/1.A.1.a.1', '/find/descriptor/result/1.A.1.a.3', '/find/descriptor/result/1.A.1.b.2', '/find/descriptor/result/1.A.1.e.3', '/find/descriptor/result/1.A.1.b.3', '/find/descriptor/result/1.A.1.g.1', '/find/descriptor/result/1.A.1.f.1', '/find/descriptor/result/1.A.1.e.1', '/find/descriptor/result/1.A.1.g.2', '/find/descriptor/result/1.A.1.f.2', '/find/descriptor/result/1.A.1.a.2', '/find/descriptor/result/1.A.1.a.4', '/find/descriptor/result/1.A.2.a.1', '/find/descriptor/result/1.A.2.b.1', '/find/descriptor/result/1.A.2.a.3', '/find/descriptor/result/1.A.2.a.2', '/find/descriptor/result/1.A.2.b.2', '/find/descriptor/result/1.A.2.b.4', '/find/descriptor/result/1.A.2.c.1', '/find/descriptor/result/1.A.2.b.3', '/find/descriptor/result/1.A.2.c.3', '/find/descriptor/result/1.A.2.c.2', '/find/descriptor/result/1.A.3.c.2', '/find/descriptor/result/1.A.3.a.3', '/find/descriptor/result/1.A.3.a.2', '/find/descriptor/result/1.A.3.c.1', '/find/descriptor/result/1.A.3.c.3', '/find/descriptor/result/1.A.3.c.4', '/find/descriptor/result/1.A.3.b.1', '/find/descriptor/result/1.A.3.a.1', '/find/descriptor/result/1.A.3.a.4', '/find/descriptor/result/1.A.4.b.2', '/find/descriptor/result/1.A.4.a.6', '/find/descriptor/result/1.A.4.a.2', '/find/descriptor/result/1.A.4.a.7', '/find/descriptor/result/1.A.4.b.1', '/find/descriptor/result/1.A.4.a.1', '/find/descriptor/result/1.A.4.a.4', '/find/descriptor/result/1.A.4.a.5', '/find/descriptor/result/1.A.4.b.3', '/find/descriptor/result/1.A.4.b.5', '/find/descriptor/result/1.A.4.b.4', '/find/descriptor/result/1.A.4.a.3', 'https://www.mynextmove.org/explore/ip', '/explore/interests/Realistic/', '/explore/interests/Investigative/', '/explore/interests/Artistic/', '/explore/interests/Social/', '/explore/interests/Enterprising/', '/explore/interests/Conventional/', '/find/descriptor/result/2.C.1.a', '/find/descriptor/result/2.C.4.d', '/find/descriptor/result/2.C.3.d', '/find/descriptor/result/2.C.4.c', '/find/descriptor/result/2.C.1.b', '/find/descriptor/result/2.C.9.b', '/find/descriptor/result/2.C.3.a', '/find/descriptor/result/2.C.1.e', '/find/descriptor/result/2.C.3.c', '/find/descriptor/result/2.C.1.c', '/find/descriptor/result/2.C.6', '/find/descriptor/result/2.C.3.b', '/find/descriptor/result/2.C.7.a', '/find/descriptor/result/2.C.7.c', '/find/descriptor/result/2.C.2.b', '/find/descriptor/result/2.C.7.b', '/find/descriptor/result/2.C.4.g', '/find/descriptor/result/2.C.7.d', '/find/descriptor/result/2.C.8.b', '/find/descriptor/result/2.C.4.a', '/find/descriptor/result/2.C.3.e', '/find/descriptor/result/2.C.5.a', '/find/descriptor/result/2.C.1.f', '/find/descriptor/result/2.C.7.e', '/find/descriptor/result/2.C.4.b', '/find/descriptor/result/2.C.2.a', '/find/descriptor/result/2.C.4.e', '/find/descriptor/result/2.C.8.a', '/find/descriptor/result/2.C.1.d', '/find/descriptor/result/2.C.4.f', '/find/descriptor/result/2.C.9.a', '/find/descriptor/result/2.C.5.b', '/find/descriptor/result/2.C.10', '/find/descriptor/browse/Skills/2.A/', '/find/descriptor/browse/Skills/2.A/', '/find/descriptor/browse/Skills/2.B.2/', '/find/descriptor/browse/Skills/2.B.2/', '/find/descriptor/browse/Skills/2.B.5/', '/find/descriptor/browse/Skills/2.B.5/', '/find/descriptor/browse/Skills/2.B.1/', '/find/descriptor/browse/Skills/2.B.1/', '/find/descriptor/browse/Skills/2.B.4/', '/find/descriptor/browse/Skills/2.B.4/', '/find/descriptor/browse/Skills/2.B.3/', '/find/descriptor/browse/Skills/2.B.3/', '/find/descriptor/result/2.A.2.b', '/find/descriptor/result/2.A.1.b', '/find/descriptor/result/2.A.2.a', '/find/descriptor/result/2.A.2.c', '/find/descriptor/result/2.A.1.e', '/find/descriptor/result/2.A.2.d', '/find/descriptor/result/2.A.1.a', '/find/descriptor/result/2.A.1.f', '/find/descriptor/result/2.A.1.d', '/find/descriptor/result/2.A.1.c', '/find/descriptor/result/2.B.1.b', '/find/descriptor/result/2.B.1.e', '/find/descriptor/result/2.B.1.d', '/find/descriptor/result/2.B.1.c', '/find/descriptor/result/2.B.1.f', '/find/descriptor/result/2.B.1.a', '/find/descriptor/result/2.B.2.i', '/find/descriptor/result/2.B.3.j', '/find/descriptor/result/2.B.3.c', '/find/descriptor/result/2.B.3.d', '/find/descriptor/result/2.B.3.h', '/find/descriptor/result/2.B.3.a', '/find/descriptor/result/2.B.3.g', '/find/descriptor/result/2.B.3.e', '/find/descriptor/result/2.B.3.m', '/find/descriptor/result/2.B.3.l', '/find/descriptor/result/2.B.3.b', '/find/descriptor/result/2.B.3.k', '/find/descriptor/result/2.B.4.e', '/find/descriptor/result/2.B.4.g', '/find/descriptor/result/2.B.4.h', '/find/descriptor/result/2.B.5.b', '/find/descriptor/result/2.B.5.c', '/find/descriptor/result/2.B.5.d', '/find/descriptor/result/2.B.5.a', '/find/descriptor/browse/Work_Activities/4.A.1/', '/find/descriptor/browse/Work_Activities/4.A.1/', '/find/descriptor/browse/Work_Activities/4.A.4/', '/find/descriptor/browse/Work_Activities/4.A.4/', '/find/descriptor/browse/Work_Activities/4.A.2/', '/find/descriptor/browse/Work_Activities/4.A.2/', '/find/descriptor/browse/Work_Activities/4.A.3/', '/find/descriptor/browse/Work_Activities/4.A.3/', '/find/descriptor/result/4.A.1.b.3', '/find/descriptor/result/4.A.1.a.1', '/find/descriptor/result/4.A.1.b.1', '/find/descriptor/result/4.A.1.b.2', '/find/descriptor/result/4.A.1.a.2', '/find/descriptor/result/4.A.2.a.4', '/find/descriptor/result/4.A.2.b.4', '/find/descriptor/result/4.A.2.a.3', '/find/descriptor/result/4.A.2.a.1', '/find/descriptor/result/4.A.2.b.1', '/find/descriptor/result/4.A.2.b.6', '/find/descriptor/result/4.A.2.a.2', '/find/descriptor/result/4.A.2.b.5', '/find/descriptor/result/4.A.2.b.2', '/find/descriptor/result/4.A.2.b.3', '/find/descriptor/result/4.A.3.a.3', '/find/descriptor/result/4.A.3.b.6', '/find/descriptor/result/4.A.3.b.2', '/find/descriptor/result/4.A.3.a.2', '/find/descriptor/result/4.A.3.b.1', '/find/descriptor/result/4.A.3.a.4', '/find/descriptor/result/4.A.3.a.1', '/find/descriptor/result/4.A.3.b.5', '/find/descriptor/result/4.A.3.b.4', '/find/descriptor/result/4.A.4.a.5', '/find/descriptor/result/4.A.4.b.5', '/find/descriptor/result/4.A.4.a.3', '/find/descriptor/result/4.A.4.a.2', '/find/descriptor/result/4.A.4.b.1', '/find/descriptor/result/4.A.4.b.2', '/find/descriptor/result/4.A.4.a.4', '/find/descriptor/result/4.A.4.b.4', '/find/descriptor/result/4.A.4.a.1', '/find/descriptor/result/4.A.4.c.3', '/find/descriptor/result/4.A.4.c.1', '/find/descriptor/result/4.A.4.a.8', '/find/descriptor/result/4.A.4.b.6', '/find/descriptor/result/4.A.4.a.7', '/find/descriptor/result/4.A.4.a.6', '/find/descriptor/result/4.A.4.c.2', '/find/descriptor/result/4.A.4.b.3', '/find/descriptor/browse/Work_Context/4.C.1/', '/find/descriptor/browse/Work_Context/4.C.1/', '/find/descriptor/browse/Work_Context/4.C.2/', '/find/descriptor/browse/Work_Context/4.C.2/', '/find/descriptor/browse/Work_Context/4.C.3/', '/find/descriptor/browse/Work_Context/4.C.3/', '/find/descriptor/result/4.C.1.a.4', '/find/descriptor/result/4.C.1.b.1.g', '/find/descriptor/result/4.C.1.b.1.f', '/find/descriptor/result/4.C.1.d.3', '/find/descriptor/result/4.C.1.d.2', '/find/descriptor/result/4.C.1.a.2.h', '/find/descriptor/result/4.C.1.a.2.l', '/find/descriptor/result/4.C.1.d.1', '/find/descriptor/result/4.C.1.a.2.j', '/find/descriptor/result/4.C.1.a.2.c', '/find/descriptor/result/4.C.1.c.2', '/find/descriptor/result/4.C.1.c.1', '/find/descriptor/result/4.C.1.a.2.f', '/find/descriptor/result/4.C.1.b.1.e', '/find/descriptor/result/4.C.2.b.1.e', '/find/descriptor/result/4.C.2.b.1.d', '/find/descriptor/result/4.C.2.c.1.b', '/find/descriptor/result/4.C.2.c.1.d', '/find/descriptor/result/4.C.2.c.1.e', '/find/descriptor/result/4.C.2.c.1.c', '/find/descriptor/result/4.C.2.c.1.f', '/find/descriptor/result/4.C.2.c.1.a', '/find/descriptor/result/4.C.2.b.1.f', '/find/descriptor/result/4.C.2.b.1.c', '/find/descriptor/result/4.C.2.a.1.f', '/find/descriptor/result/4.C.2.a.1.e', '/find/descriptor/result/4.C.2.a.1.a', '/find/descriptor/result/4.C.2.a.1.b', '/find/descriptor/result/4.C.2.a.1.c', '/find/descriptor/result/4.C.2.a.1.d', '/find/descriptor/result/4.C.2.a.3', '/find/descriptor/result/4.C.2.b.1.a', '/find/descriptor/result/4.C.2.d.1.h', '/find/descriptor/result/4.C.2.d.1.c', '/find/descriptor/result/4.C.2.d.1.f', '/find/descriptor/result/4.C.2.d.1.e', '/find/descriptor/result/4.C.2.d.1.i', '/find/descriptor/result/4.C.2.d.1.a', '/find/descriptor/result/4.C.2.d.1.b', '/find/descriptor/result/4.C.2.d.1.g', '/find/descriptor/result/4.C.2.d.1.d', '/find/descriptor/result/4.C.2.b.1.b', '/find/descriptor/result/4.C.2.e.1.d', '/find/descriptor/result/4.C.2.e.1.e', '/find/descriptor/result/4.C.3.a.1', '/find/descriptor/result/4.C.3.b.2', '/find/descriptor/result/4.C.3.d.8', '/find/descriptor/result/4.C.3.a.4', '/find/descriptor/result/4.C.3.a.2.b', '/find/descriptor/result/4.C.3.a.2.a', '/find/descriptor/result/4.C.3.b.4', '/find/descriptor/result/4.C.3.b.7', '/find/descriptor/result/4.C.3.c.1', '/find/descriptor/result/4.C.3.d.3', '/find/descriptor/result/4.C.3.b.8', '/find/descriptor/result/4.C.3.d.1', '/find/descriptor/result/4.C.3.d.4', '/find/descriptor/result/1.C.1.a', '/find/descriptor/result/1.C.4.c', '/find/descriptor/result/1.C.7.b', '/find/descriptor/result/1.C.5.b', '/find/descriptor/result/1.C.3.b', '/find/descriptor/result/1.C.3.a', '/find/descriptor/result/1.C.5.a', '/find/descriptor/result/1.C.6', '/find/descriptor/result/1.C.1.c', '/find/descriptor/result/1.C.7.a', '/find/descriptor/result/1.C.5.c', '/find/descriptor/result/1.C.2.b', '/find/descriptor/result/1.C.1.b', '/find/descriptor/result/1.C.4.a', '/find/descriptor/result/1.C.3.c', '/find/descriptor/result/1.C.4.b', '/explore/workvalues/Achievement/', '/explore/workvalues/Independence/', '/explore/workvalues/Recognition/', '/explore/workvalues/Relationships/', '/explore/workvalues/Support/', '/explore/workvalues/Working_Conditions/']
    lst_complete_url=[]
    for url in lst_broken_url:
        url_sub_cat=(host_url+url)
        lst_complete_url.append(url_sub_cat)
    return lst_complete_url





'''split the list "lst_complete_url" to list "good_url" if there is a table (using pandas) and to list "bad_url" if there is no table. 
You must copy the output. No csv etc.
'''
def split_list():
    good_url=[]
    bad_url=[]
    for url in lst_complete_url:
        try:
            time.sleep(1)
            source=pd.read_html(url)
            print("good", url)
            good_url.append(url)
            print(good_url)
        except ValueError:
            time.sleep(1)
            print("error",url)
            bad_url.append(url)
            print(bad_url)
            pass
        except:
            pass




def extract_to_csv():
    url_no_table=['https://www.onetonline.org/find/descriptor/browse/Abilities/1.A.1/', 'https://www.onetonline.org/find/descriptor/browse/Abilities/1.A.1/', 'https://www.onetonline.org/find/descriptor/browse/Abilities/1.A.3/', 'https://www.onetonline.org/find/descriptor/browse/Abilities/1.A.3/', 'https://www.onetonline.org/find/descriptor/browse/Abilities/1.A.2/', 'https://www.onetonline.org/find/descriptor/browse/Abilities/1.A.2/', 'https://www.onetonline.org/find/descriptor/browse/Abilities/1.A.4/', 'https://www.onetonline.org/find/descriptor/browse/Abilities/1.A.4/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.A/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.A/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.B.2/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.B.2/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.B.5/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.B.5/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.B.1/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.B.1/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.B.4/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.B.4/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.B.3/', 'https://www.onetonline.org/find/descriptor/browse/Skills/2.B.3/', 'https://www.onetonline.org/find/descriptor/browse/Work_Activities/4.A.1/', 'https://www.onetonline.org/find/descriptor/browse/Work_Activities/4.A.1/', 'https://www.onetonline.org/find/descriptor/browse/Work_Activities/4.A.4/', 'https://www.onetonline.org/find/descriptor/browse/Work_Activities/4.A.4/', 'https://www.onetonline.org/find/descriptor/browse/Work_Activities/4.A.2/', 'https://www.onetonline.org/find/descriptor/browse/Work_Activities/4.A.2/', 'https://www.onetonline.org/find/descriptor/browse/Work_Activities/4.A.3/', 'https://www.onetonline.org/find/descriptor/browse/Work_Activities/4.A.3/', 'https://www.onetonline.org/find/descriptor/browse/Work_Context/4.C.1/', 'https://www.onetonline.org/find/descriptor/browse/Work_Context/4.C.1/', 'https://www.onetonline.org/find/descriptor/browse/Work_Context/4.C.2/', 'https://www.onetonline.org/find/descriptor/browse/Work_Context/4.C.2/', 'https://www.onetonline.org/find/descriptor/browse/Work_Context/4.C.3/', 'https://www.onetonline.org/find/descriptor/browse/Work_Context/4.C.3/']
    url_table=['https://www.onetonline.org/find/descriptor/result/1.A.1.b.7', 'https://www.onetonline.org/find/descriptor/result/1.A.1.b.4', 'https://www.onetonline.org/find/descriptor/result/1.A.1.e.2', 'https://www.onetonline.org/find/descriptor/result/1.A.1.b.1', 'https://www.onetonline.org/find/descriptor/result/1.A.1.b.5', 'https://www.onetonline.org/find/descriptor/result/1.A.1.b.6', 'https://www.onetonline.org/find/descriptor/result/1.A.1.c.1', 'https://www.onetonline.org/find/descriptor/result/1.A.1.d.1', 'https://www.onetonline.org/find/descriptor/result/1.A.1.c.2', 'https://www.onetonline.org/find/descriptor/result/1.A.1.a.1', 'https://www.onetonline.org/find/descriptor/result/1.A.1.a.3', 'https://www.onetonline.org/find/descriptor/result/1.A.1.b.2', 'https://www.onetonline.org/find/descriptor/result/1.A.1.e.3', 'https://www.onetonline.org/find/descriptor/result/1.A.1.b.3', 'https://www.onetonline.org/find/descriptor/result/1.A.1.g.1', 'https://www.onetonline.org/find/descriptor/result/1.A.1.f.1', 'https://www.onetonline.org/find/descriptor/result/1.A.1.e.1', 'https://www.onetonline.org/find/descriptor/result/1.A.1.g.2', 'https://www.onetonline.org/find/descriptor/result/1.A.1.f.2', 'https://www.onetonline.org/find/descriptor/result/1.A.1.a.2', 'https://www.onetonline.org/find/descriptor/result/1.A.1.a.4', 'https://www.onetonline.org/find/descriptor/result/1.A.2.a.1', 'https://www.onetonline.org/find/descriptor/result/1.A.2.b.1', 'https://www.onetonline.org/find/descriptor/result/1.A.2.a.3', 'https://www.onetonline.org/find/descriptor/result/1.A.2.a.2', 'https://www.onetonline.org/find/descriptor/result/1.A.2.b.2', 'https://www.onetonline.org/find/descriptor/result/1.A.2.b.4', 'https://www.onetonline.org/find/descriptor/result/1.A.2.c.1', 'https://www.onetonline.org/find/descriptor/result/1.A.2.b.3', 'https://www.onetonline.org/find/descriptor/result/1.A.2.c.3', 'https://www.onetonline.org/find/descriptor/result/1.A.2.c.2', 'https://www.onetonline.org/find/descriptor/result/1.A.3.c.2', 'https://www.onetonline.org/find/descriptor/result/1.A.3.a.3', 'https://www.onetonline.org/find/descriptor/result/1.A.3.a.2', 'https://www.onetonline.org/find/descriptor/result/1.A.3.c.1', 'https://www.onetonline.org/find/descriptor/result/1.A.3.c.3', 'https://www.onetonline.org/find/descriptor/result/1.A.3.c.4', 'https://www.onetonline.org/find/descriptor/result/1.A.3.b.1', 'https://www.onetonline.org/find/descriptor/result/1.A.3.a.1', 'https://www.onetonline.org/find/descriptor/result/1.A.3.a.4', 'https://www.onetonline.org/find/descriptor/result/1.A.4.b.2', 'https://www.onetonline.org/find/descriptor/result/1.A.4.a.6', 'https://www.onetonline.org/find/descriptor/result/1.A.4.a.2', 'https://www.onetonline.org/find/descriptor/result/1.A.4.a.7', 'https://www.onetonline.org/find/descriptor/result/1.A.4.b.1', 'https://www.onetonline.org/find/descriptor/result/1.A.4.a.1', 'https://www.onetonline.org/find/descriptor/result/1.A.4.a.4', 'https://www.onetonline.org/find/descriptor/result/1.A.4.a.5', 'https://www.onetonline.org/find/descriptor/result/1.A.4.b.3', 'https://www.onetonline.org/find/descriptor/result/1.A.4.b.5', 'https://www.onetonline.org/find/descriptor/result/1.A.4.b.4', 'https://www.onetonline.org/find/descriptor/result/1.A.4.a.3', 'https://www.onetonline.org/explore/interests/Realistic/', 'https://www.onetonline.org/explore/interests/Investigative/', 'https://www.onetonline.org/explore/interests/Artistic/', 'https://www.onetonline.org/explore/interests/Social/', 'https://www.onetonline.org/explore/interests/Enterprising/', 'https://www.onetonline.org/explore/interests/Conventional/', 'https://www.onetonline.org/find/descriptor/result/2.C.1.a', 'https://www.onetonline.org/find/descriptor/result/2.C.4.d', 'https://www.onetonline.org/find/descriptor/result/2.C.3.d', 'https://www.onetonline.org/find/descriptor/result/2.C.4.c', 'https://www.onetonline.org/find/descriptor/result/2.C.1.b', 'https://www.onetonline.org/find/descriptor/result/2.C.9.b', 'https://www.onetonline.org/find/descriptor/result/2.C.3.a', 'https://www.onetonline.org/find/descriptor/result/2.C.1.e', 'https://www.onetonline.org/find/descriptor/result/2.C.3.c', 'https://www.onetonline.org/find/descriptor/result/2.C.1.c', 'https://www.onetonline.org/find/descriptor/result/2.C.6', 'https://www.onetonline.org/find/descriptor/result/2.C.3.b', 'https://www.onetonline.org/find/descriptor/result/2.C.7.a', 'https://www.onetonline.org/find/descriptor/result/2.C.7.c', 'https://www.onetonline.org/find/descriptor/result/2.C.2.b', 'https://www.onetonline.org/find/descriptor/result/2.C.7.b', 'https://www.onetonline.org/find/descriptor/result/2.C.4.g', 'https://www.onetonline.org/find/descriptor/result/2.C.7.d', 'https://www.onetonline.org/find/descriptor/result/2.C.8.b', 'https://www.onetonline.org/find/descriptor/result/2.C.4.a', 'https://www.onetonline.org/find/descriptor/result/2.C.3.e', 'https://www.onetonline.org/find/descriptor/result/2.C.5.a', 'https://www.onetonline.org/find/descriptor/result/2.C.1.f', 'https://www.onetonline.org/find/descriptor/result/2.C.7.e', 'https://www.onetonline.org/find/descriptor/result/2.C.4.b', 'https://www.onetonline.org/find/descriptor/result/2.C.2.a', 'https://www.onetonline.org/find/descriptor/result/2.C.4.e', 'https://www.onetonline.org/find/descriptor/result/2.C.8.a', 'https://www.onetonline.org/find/descriptor/result/2.C.1.d', 'https://www.onetonline.org/find/descriptor/result/2.C.4.f', 'https://www.onetonline.org/find/descriptor/result/2.C.9.a', 'https://www.onetonline.org/find/descriptor/result/2.C.5.b', 'https://www.onetonline.org/find/descriptor/result/2.C.10', 'https://www.onetonline.org/find/descriptor/result/2.A.2.b', 'https://www.onetonline.org/find/descriptor/result/2.A.1.b', 'https://www.onetonline.org/find/descriptor/result/2.A.2.a', 'https://www.onetonline.org/find/descriptor/result/2.A.2.c', 'https://www.onetonline.org/find/descriptor/result/2.A.1.e', 'https://www.onetonline.org/find/descriptor/result/2.A.2.d', 'https://www.onetonline.org/find/descriptor/result/2.A.1.a', 'https://www.onetonline.org/find/descriptor/result/2.A.1.f', 'https://www.onetonline.org/find/descriptor/result/2.A.1.d', 'https://www.onetonline.org/find/descriptor/result/2.A.1.c', 'https://www.onetonline.org/find/descriptor/result/2.B.1.b', 'https://www.onetonline.org/find/descriptor/result/2.B.1.e', 'https://www.onetonline.org/find/descriptor/result/2.B.1.d', 'https://www.onetonline.org/find/descriptor/result/2.B.1.c', 'https://www.onetonline.org/find/descriptor/result/2.B.1.f', 'https://www.onetonline.org/find/descriptor/result/2.B.1.a', 'https://www.onetonline.org/find/descriptor/result/2.B.2.i', 'https://www.onetonline.org/find/descriptor/result/2.B.3.j', 'https://www.onetonline.org/find/descriptor/result/2.B.3.c', 'https://www.onetonline.org/find/descriptor/result/2.B.3.d', 'https://www.onetonline.org/find/descriptor/result/2.B.3.h', 'https://www.onetonline.org/find/descriptor/result/2.B.3.a', 'https://www.onetonline.org/find/descriptor/result/2.B.3.g', 'https://www.onetonline.org/find/descriptor/result/2.B.3.e', 'https://www.onetonline.org/find/descriptor/result/2.B.3.m', 'https://www.onetonline.org/find/descriptor/result/2.B.3.l', 'https://www.onetonline.org/find/descriptor/result/2.B.3.b', 'https://www.onetonline.org/find/descriptor/result/2.B.3.k', 'https://www.onetonline.org/find/descriptor/result/2.B.4.e', 'https://www.onetonline.org/find/descriptor/result/2.B.4.g', 'https://www.onetonline.org/find/descriptor/result/2.B.4.h', 'https://www.onetonline.org/find/descriptor/result/2.B.5.b', 'https://www.onetonline.org/find/descriptor/result/2.B.5.c', 'https://www.onetonline.org/find/descriptor/result/2.B.5.d', 'https://www.onetonline.org/find/descriptor/result/2.B.5.a', 'https://www.onetonline.org/find/descriptor/result/4.A.1.b.3', 'https://www.onetonline.org/find/descriptor/result/4.A.1.a.1', 'https://www.onetonline.org/find/descriptor/result/4.A.1.b.1', 'https://www.onetonline.org/find/descriptor/result/4.A.1.b.2', 'https://www.onetonline.org/find/descriptor/result/4.A.1.a.2', 'https://www.onetonline.org/find/descriptor/result/4.A.2.a.4', 'https://www.onetonline.org/find/descriptor/result/4.A.2.b.4', 'https://www.onetonline.org/find/descriptor/result/4.A.2.a.3', 'https://www.onetonline.org/find/descriptor/result/4.A.2.a.1', 'https://www.onetonline.org/find/descriptor/result/4.A.2.b.1', 'https://www.onetonline.org/find/descriptor/result/4.A.2.b.6', 'https://www.onetonline.org/find/descriptor/result/4.A.2.a.2', 'https://www.onetonline.org/find/descriptor/result/4.A.2.b.5', 'https://www.onetonline.org/find/descriptor/result/4.A.2.b.2', 'https://www.onetonline.org/find/descriptor/result/4.A.2.b.3', 'https://www.onetonline.org/find/descriptor/result/4.A.3.a.3', 'https://www.onetonline.org/find/descriptor/result/4.A.3.b.6', 'https://www.onetonline.org/find/descriptor/result/4.A.3.b.2', 'https://www.onetonline.org/find/descriptor/result/4.A.3.a.2', 'https://www.onetonline.org/find/descriptor/result/4.A.3.b.1', 'https://www.onetonline.org/find/descriptor/result/4.A.3.a.4', 'https://www.onetonline.org/find/descriptor/result/4.A.3.a.1', 'https://www.onetonline.org/find/descriptor/result/4.A.3.b.5', 'https://www.onetonline.org/find/descriptor/result/4.A.3.b.4', 'https://www.onetonline.org/find/descriptor/result/4.A.4.a.5', 'https://www.onetonline.org/find/descriptor/result/4.A.4.b.5', 'https://www.onetonline.org/find/descriptor/result/4.A.4.a.3', 'https://www.onetonline.org/find/descriptor/result/4.A.4.a.2', 'https://www.onetonline.org/find/descriptor/result/4.A.4.b.1', 'https://www.onetonline.org/find/descriptor/result/4.A.4.b.2', 'https://www.onetonline.org/find/descriptor/result/4.A.4.a.4', 'https://www.onetonline.org/find/descriptor/result/4.A.4.b.4', 'https://www.onetonline.org/find/descriptor/result/4.A.4.a.1', 'https://www.onetonline.org/find/descriptor/result/4.A.4.c.3', 'https://www.onetonline.org/find/descriptor/result/4.A.4.c.1', 'https://www.onetonline.org/find/descriptor/result/4.A.4.a.8', 'https://www.onetonline.org/find/descriptor/result/4.A.4.b.6', 'https://www.onetonline.org/find/descriptor/result/4.A.4.a.7', 'https://www.onetonline.org/find/descriptor/result/4.A.4.a.6', 'https://www.onetonline.org/find/descriptor/result/4.A.4.c.2', 'https://www.onetonline.org/find/descriptor/result/4.A.4.b.3', 'https://www.onetonline.org/find/descriptor/result/4.C.1.a.4', 'https://www.onetonline.org/find/descriptor/result/4.C.1.b.1.g', 'https://www.onetonline.org/find/descriptor/result/4.C.1.b.1.f', 'https://www.onetonline.org/find/descriptor/result/4.C.1.d.3', 'https://www.onetonline.org/find/descriptor/result/4.C.1.d.2', 'https://www.onetonline.org/find/descriptor/result/4.C.1.a.2.h', 'https://www.onetonline.org/find/descriptor/result/4.C.1.a.2.l', 'https://www.onetonline.org/find/descriptor/result/4.C.1.d.1', 'https://www.onetonline.org/find/descriptor/result/4.C.1.a.2.j', 'https://www.onetonline.org/find/descriptor/result/4.C.1.a.2.c', 'https://www.onetonline.org/find/descriptor/result/4.C.1.c.2', 'https://www.onetonline.org/find/descriptor/result/4.C.1.c.1', 'https://www.onetonline.org/find/descriptor/result/4.C.1.a.2.f', 'https://www.onetonline.org/find/descriptor/result/4.C.1.b.1.e', 'https://www.onetonline.org/find/descriptor/result/4.C.2.b.1.e', 'https://www.onetonline.org/find/descriptor/result/4.C.2.b.1.d', 'https://www.onetonline.org/find/descriptor/result/4.C.2.c.1.b', 'https://www.onetonline.org/find/descriptor/result/4.C.2.c.1.d', 'https://www.onetonline.org/find/descriptor/result/4.C.2.c.1.e', 'https://www.onetonline.org/find/descriptor/result/4.C.2.c.1.c', 'https://www.onetonline.org/find/descriptor/result/4.C.2.c.1.f', 'https://www.onetonline.org/find/descriptor/result/4.C.2.c.1.a', 'https://www.onetonline.org/find/descriptor/result/4.C.2.b.1.f', 'https://www.onetonline.org/find/descriptor/result/4.C.2.b.1.c', 'https://www.onetonline.org/find/descriptor/result/4.C.2.a.1.f', 'https://www.onetonline.org/find/descriptor/result/4.C.2.a.1.e', 'https://www.onetonline.org/find/descriptor/result/4.C.2.a.1.a', 'https://www.onetonline.org/find/descriptor/result/4.C.2.a.1.b', 'https://www.onetonline.org/find/descriptor/result/4.C.2.a.1.c', 'https://www.onetonline.org/find/descriptor/result/4.C.2.a.1.d', 'https://www.onetonline.org/find/descriptor/result/4.C.2.a.3', 'https://www.onetonline.org/find/descriptor/result/4.C.2.b.1.a', 'https://www.onetonline.org/find/descriptor/result/4.C.2.d.1.h', 'https://www.onetonline.org/find/descriptor/result/4.C.2.d.1.c', 'https://www.onetonline.org/find/descriptor/result/4.C.2.d.1.f', 'https://www.onetonline.org/find/descriptor/result/4.C.2.d.1.e', 'https://www.onetonline.org/find/descriptor/result/4.C.2.d.1.i', 'https://www.onetonline.org/find/descriptor/result/4.C.2.d.1.a', 'https://www.onetonline.org/find/descriptor/result/4.C.2.d.1.b', 'https://www.onetonline.org/find/descriptor/result/4.C.2.d.1.g', 'https://www.onetonline.org/find/descriptor/result/4.C.2.d.1.d', 'https://www.onetonline.org/find/descriptor/result/4.C.2.b.1.b', 'https://www.onetonline.org/find/descriptor/result/4.C.2.e.1.d', 'https://www.onetonline.org/find/descriptor/result/4.C.2.e.1.e', 'https://www.onetonline.org/find/descriptor/result/4.C.3.a.1', 'https://www.onetonline.org/find/descriptor/result/4.C.3.b.2', 'https://www.onetonline.org/find/descriptor/result/4.C.3.d.8', 'https://www.onetonline.org/find/descriptor/result/4.C.3.a.4', 'https://www.onetonline.org/find/descriptor/result/4.C.3.a.2.b', 'https://www.onetonline.org/find/descriptor/result/4.C.3.a.2.a', 'https://www.onetonline.org/find/descriptor/result/4.C.3.b.4', 'https://www.onetonline.org/find/descriptor/result/4.C.3.b.7', 'https://www.onetonline.org/find/descriptor/result/4.C.3.c.1', 'https://www.onetonline.org/find/descriptor/result/4.C.3.d.3', 'https://www.onetonline.org/find/descriptor/result/4.C.3.b.8', 'https://www.onetonline.org/find/descriptor/result/4.C.3.d.1', 'https://www.onetonline.org/find/descriptor/result/4.C.3.d.4', 'https://www.onetonline.org/find/descriptor/result/1.C.1.a', 'https://www.onetonline.org/find/descriptor/result/1.C.4.c', 'https://www.onetonline.org/find/descriptor/result/1.C.7.b', 'https://www.onetonline.org/find/descriptor/result/1.C.5.b', 'https://www.onetonline.org/find/descriptor/result/1.C.3.b', 'https://www.onetonline.org/find/descriptor/result/1.C.3.a', 'https://www.onetonline.org/find/descriptor/result/1.C.5.a', 'https://www.onetonline.org/find/descriptor/result/1.C.6', 'https://www.onetonline.org/find/descriptor/result/1.C.1.c', 'https://www.onetonline.org/find/descriptor/result/1.C.7.a', 'https://www.onetonline.org/find/descriptor/result/1.C.5.c', 'https://www.onetonline.org/find/descriptor/result/1.C.2.b', 'https://www.onetonline.org/find/descriptor/result/1.C.1.b', 'https://www.onetonline.org/find/descriptor/result/1.C.4.a', 'https://www.onetonline.org/find/descriptor/result/1.C.3.c', 'https://www.onetonline.org/find/descriptor/result/1.C.4.b', 'https://www.onetonline.org/explore/workvalues/Achievement/', 'https://www.onetonline.org/explore/workvalues/Independence/', 'https://www.onetonline.org/explore/workvalues/Recognition/', 'https://www.onetonline.org/explore/workvalues/Relationships/', 'https://www.onetonline.org/explore/workvalues/Support/', 'https://www.onetonline.org/explore/workvalues/Working_Conditions/']
    for url in url_table:
        time.sleep(1)
        count=0
        source = pd.read_html(url)
        print(source)
        url=url.split("/")[-1]
        name=str(url)
        source[count].to_csv(name)
        count=count+1

'''README
Here you find all functions.
Uncomment lst_complete_url=(all_url()) and split_list() to get splitted lists with tables and without tables
Uncomment extract_to_csv() to get the csv files with the tables. Open in Atom.
'''
# categories = get_categories()

# sub_categories= get_sub_categories()

# lst_complete_url=(all_url())

# split_list()
# extract_to_csv()




